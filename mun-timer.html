<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUN Timer App</title>
    <link rel="stylesheet" href="css/mun-timer.css">
</head>

<body>
    <div class="container">
        <!-- Left Panel: Topics/Agenda -->
        <div class="panel left-panel">
            <h2>üìã Topics & Agenda</h2>
            <div id="topicsList"></div>
            <button class="add-button" onclick="addNewTopic()">+ Add Topic</button>
        </div>

        <!-- Center Panel: Current Event Display -->
        <div class="panel center-panel">
            <div class="control-buttons">
                <button class="control-btn" onclick="openAddEventModal()">+ Add Event</button>
                <button class="control-btn" onclick="openJSONEditor()">Edit JSON</button>
                <button class="control-btn" onclick="copyJSON()">Copy JSON</button>
                <button class="control-btn" onclick="downloadJSON()">Save JSON</button>
                <button class="control-btn" onclick="triggerLoadJSON()">Load JSON</button>
            </div>
            <div id="eventDisplay" class="event-display">
                <div class="event-title">Welcome to MUN</div>
                <div class="event-subtitle">Select an event to begin</div>
            </div>
        </div>

        <!-- Right Panel: Timeline -->
        <div class="panel right-panel">
            <h2>‚è±Ô∏è Timeline</h2>
            <div id="timelineList"></div>
            <button class="add-button" onclick="openAddEventModal()">+ Add Event</button>
        </div>
    </div>

    <!-- Motions Panel -->
    <div class="motions-panel" id="motionsPanel">
        <div class="motions-header">
            <h2>üìú Motions</h2>
            <button class="toggle-panel-btn" onclick="toggleMotionsPanel()" title="Hide Motion Panel">‚àí</button>
        </div>
        <div class="motions-content" id="motionsContent">
            <button class="add-motion-button" onclick="openMotionTypePanel()">+ Add Motion</button>
            <div class="motion-queue" id="motionQueue"></div>
            <div class="voting-display" id="votingDisplay" style="display: none;">
                <h3>Current Motion Voting</h3>
                <div class="motion-details" id="motionDetails"></div>
                <div class="voting-status">
                    <div class="vote-inputs">
                        <div class="vote-input-group yes">
                            <label for="yesInput">Yes:</label>
                            <input type="number" id="yesInput" min="0" value="0" oninput="updateVotingFromInputs()">
                        </div>
                        <div class="vote-input-group no">
                            <label for="noInput">No:</label>
                            <input type="number" id="noInput" min="0" value="0" oninput="updateVotingFromInputs()">
                        </div>
                        <div class="vote-input-group abstain">
                            <label for="abstainInput">Abstain:</label>
                            <input type="number" id="abstainInput" min="0" value="0" oninput="updateVotingFromInputs()">
                        </div>
                    </div>
                    <div class="majority-indicator">
                        Required: <span class="threshold" id="requiredVotes">0</span>
                    </div>
                </div>
                <div class="voting-result pending" id="votingResult">
                    Enter vote counts
                </div>
                <div class="modal-buttons" style="margin-top: 12px;">
                    <button class="modal-btn secondary" onclick="cancelMotionVoting()">Cancel Motion</button>
                    <button class="modal-btn primary" onclick="finalizeVoting()">Finalize Vote</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Motion Type Selection Modal -->
    <div class="modal" id="motionTypeModal">
        <div class="modal-content motion-type-content">
            <h2>Select Motion Type</h2>
            <p style="color: #6c757d; margin-bottom: 16px; font-size: 0.9em;">
                Motions are ordered by disturbance level (1 = most disruptive)
            </p>
            <div class="motion-types-scroll" id="motionTypesList"></div>
            <div class="modal-buttons" style="margin-top: 16px;">
                <button class="modal-btn secondary" onclick="closeMotionTypePanel()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Delegates Bar -->
    <div class="delegates-bar" id="delegatesBar"></div>

    <!-- Motion Submission Modal -->
    <div class="modal" id="motionModal">
        <div class="modal-content">
            <h2 id="motionModalTitle">Submit Motion</h2>
            <div id="motionParamsForm"></div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeMotionModal()">Cancel</button>
                <button class="modal-btn primary" onclick="submitMotion()">Submit Motion</button>
            </div>
        </div>
    </div>

    <!-- Attendance Selection Modal -->
    <div class="modal" id="attendanceModal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <h2 id="attendanceModalTitle">Set Attendance</h2>
            <p id="attendanceDelegate"
                style="color: #6c757d; margin-bottom: 16px; text-align: center; font-size: 1.1em;"></p>
            <div class="attendance-options">
                <button class="attendance-btn present" onclick="setAttendance('present')">
                    <span class="icon">‚úì</span>
                    <span class="title">Present</span>
                    <span class="description">Can vote with abstentions</span>
                </button>
                <button class="attendance-btn present-voting" onclick="setAttendance('present-voting')">
                    <span class="icon">‚úì‚úì</span>
                    <span class="title">Present and Voting</span>
                    <span class="description">Cannot abstain</span>
                </button>
                <button class="attendance-btn absent" onclick="setAttendance('absent')">
                    <span class="icon">‚úó</span>
                    <span class="title">Absent</span>
                    <span class="description">Not present</span>
                </button>
                <button class="attendance-btn none" onclick="setAttendance('none')">
                    <span class="icon">‚óã</span>
                    <span class="title">Clear Status</span>
                    <span class="description">Reset to default</span>
                </button>
            </div>
            <div class="modal-buttons" style="margin-top: 16px;">
                <button class="modal-btn secondary" onclick="closeAttendanceModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Add Event Modal -->
    <div class="modal" id="addEventModal">
        <div class="modal-content">
            <h2>Add New Event</h2>
            <div class="form-group">
                <label>Event Type</label>
                <select id="newEventType" onchange="updateEventForm()">
                    <option value="general">General</option>
                    <option value="moderated">Moderated Caucus</option>
                    <option value="unmoderated">Unmoderated Caucus</option>
                    <option value="voting">Voting</option>
                    <option value="speeches">Speeches</option>
                </select>
            </div>
            <div class="form-group">
                <label>Title</label>
                <input type="text" id="newEventTitle" placeholder="Event Title">
            </div>
            <div class="form-group">
                <label>Subtitle</label>
                <input type="text" id="newEventSubtitle" placeholder="Event Subtitle">
            </div>
            <div class="form-group">
                <label>Topic (Optional)</label>
                <select id="newEventTopic">
                    <option value="">None</option>
                </select>
            </div>
            <div id="eventSpecificFields"></div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeAddEventModal()">Cancel</button>
                <button class="modal-btn primary" onclick="addNewEvent()">Add Event</button>
            </div>
        </div>
    </div>

    <!-- JSON Editor Modal -->
    <div class="modal" id="jsonEditorModal">
        <div class="modal-content">
            <h2>Edit JSON Data</h2>
            <div class="form-group">
                <label>JSON Data</label>
                <textarea id="jsonEditor"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeJSONEditor()">Cancel</button>
                <button class="modal-btn primary" onclick="saveJSON()">Save</button>
            </div>
        </div>
    </div>

    <!-- Security Council Config Modal -->
    <div class="modal" id="scConfigModal">
        <div class="modal-content">
            <h2>Configure Security Council</h2>
            <div class="form-group">
                <label>Members (select delegates)</label>
                <div id="scMembersList" class="sc-list"></div>
            </div>
            <div class="form-group">
                <label>Permanent Members (P5)</label>
                <div id="scP5List" class="sc-list"></div>
                <div class="sc-actions">
                    <button class="modal-btn secondary" onclick="scSelectStandardP5()">Use Standard P5</button>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeSCConfig()">Close</button>
                <button class="modal-btn primary" onclick="saveSCConfig()">Save</button>
            </div>
        </div>
    </div>

    <script src="js/mun-timer.js" defer></script>
    <!-- Hidden file input for loading JSON -->
    <input type="file" id="jsonFileInput" accept="application/json,.json" style="display:none" aria-hidden="true" />
</body>

</html>